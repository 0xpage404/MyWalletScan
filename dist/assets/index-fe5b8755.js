import{r as o,j as t}from"./index-b2ef79c2.js";import{n as N}from"./FileSaver.min-7cd7f937.js";import{a as re}from"./axios-4a70c6fc.js";import{F as I}from"./index-172dc63e.js";import{S as h,I as te,E as se,a as ne}from"./index-fa1a6c2a.js";import{T as ae,a as oe}from"./index-7b773b73.js";import{C as ie}from"./index-08b925e2.js";import{B as K,E as le}from"./EditOutlined-8b010ab0.js";import{L as ce}from"./index-5e132e59.js";import{m as J}from"./index-d3e2e81c.js";import{S as de}from"./SyncOutlined-620b68af.js";import"./useFlexGapSupport-2bb9cee6.js";import"./Sider-05241123.js";import"./row-431da211.js";import"./PlusOutlined-23b712b3.js";import"./index-d41603e6.js";async function H(u,k){try{u=u.toLowerCase();let y=`https://api.lineascan.build/api?module=account&action=txlist&address=${u}&startblock=1&endblock=99999999&sort=asc&apikey=${k}`,c=(await re.get(y)).data.result;if(c.length===0)return"No transactions";c=c==null?void 0:c.filter(p=>p.from===u);let f=c==null?void 0:c.map(p=>p.to);f=f==null?void 0:f.map(p=>p.toLowerCase());let S=c==null?void 0:c.map(p=>p.timeStamp*1e3);return[f,S]}catch(y){return console.error(y),"Error"}}const{Content:ue}=ce;function _e(){o.useState(0),o.useState(0),o.useState(!1),o.useState({});const[u,k]=o.useState([]);o.useState(!1),o.useState(!1),I.useForm(),I.useForm();const[y,b]=o.useState([]);I.useForm(),o.useState(!1);const[c,f]=o.useState(!1),[S,p]=o.useState(!1),[j,_]=o.useState(new Map),[M,z]=o.useState([]),[$,A]=o.useState(!1),[R,Q]=o.useState(0),[C,V]=o.useState(!1),[L,X]=o.useState(localStorage.getItem("linea_api_key")),P="0x272e156df8da513c69cb41cc7a99185d53f926bb",F="0x009a0b7c38b542208936f1179151cd08e2943833",v="0x80e38291e06339d10aab483c65695d004dbd5c69",B="0x032b241De86a8660f1Ae0691a4760B426EA246d7",D="0xc66149996d0263C0B42D3bC05e50Db88658106cE",T="0x169C06b4cfB09bFD73A81e6f2Bb1eB514D75bB19",O="0x91067B912f89dFCa50c3F5529dBeB78b63C6a2E5";o.useEffect(()=>{const e=localStorage.getItem("linea_api_key");e&&X(e)},[]);const Z=()=>{V(!C)},q=()=>C?t.jsx(se,{}):t.jsx(ne,{}),G=async()=>{try{const e=[...u],r=[];for(let s of e)r.push(()=>new Promise(a=>{const n=w(s.address,P);s.horizon=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,F);s.bank=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,v);s.sync=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,B);s.izi=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,D);s.echo=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,T);s.leet=n,a()})),r.push(()=>new Promise(a=>{const n=w(s.address,O);s.swirl=n,a()}));await Promise.all(r.map(s=>s())),z([...e]),localStorage.setItem("linea_addresses",JSON.stringify(e))}catch(e){console.error(e)}finally{f(!1)}},U=async()=>{if(!y.length){N.error({message:"错误",description:"请先选择要刷新的地址"},2);return}f(!0);try{const e=[...u],r=[];for(let s of y){const a=e.findIndex(n=>n.key===s);if(a!==-1){const n=e[a],m=new Map,d=(await H(n.address,L))[0];m.set(n.address,d),_(m),await new Promise(l=>{setTimeout(()=>{l()},200)}),r.push(()=>new Promise(l=>{const i=x(d,P);n.horizon=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,F);n.bank=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,v);n.sync=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,B);n.izi=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,D);n.echo=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,T);n.leet=i,l()})),r.push(()=>new Promise(l=>{const i=x(d,O);n.swirl=i,l()}))}}await Promise.all(r.map(s=>s())),z([...e]),localStorage.setItem("linea_addresses",JSON.stringify(e)),J.success("刷新成功")}catch(e){N.error({message:"错误",description:e.message},2)}finally{f(!1),b([])}},w=(e,r)=>{r=r.toLowerCase();const s=j.get(e);return s==null?(J.info("等待数据加载完成再刷新"),"error"):s==null?void 0:s.reduce((n,m)=>m===r?n+1:n,0)},x=(e,r)=>(r=r.toLowerCase(),e==null?void 0:e.reduce((a,n)=>n===r?a+1:a,0));o.useEffect(()=>{const e=()=>{Q(window.innerHeight-180)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),o.useEffect(()=>{p(!0);const e=localStorage.getItem("linea_addresses");e&&(k(JSON.parse(e)),z(JSON.parse(e))),(async()=>{const s=JSON.parse(e);if(!s)return;const a=new Map;let n=[];const m=[];for(const g of s){const d=g.address,l=H(d,L).then(i=>{a.set(d,i[0]),n.push(i[1])}).catch(i=>{console.error(`Error fetching tasks for address ${d}:`,i)});m.push(l)}try{await Promise.all(m),p(!1),_(a);const g=n.flat();localStorage.setItem("linea_timestamps",JSON.stringify(g))}catch(g){console.error("Error fetching task contracts:",g)}})()},[]),o.useEffect(()=>{!$&&u.length>0&&j.size>0&&(G(),A(!0))},[u,j]);const W={selectedRowKeys:y,onChange:e=>{b(e)}},[Y,E]=o.useState(null),ee=[{title:"#",key:"index",align:"center",render:(e,r,s)=>s+1,width:34.5},{title:"备注",dataIndex:"name",key:"name",align:"center",render:(e,r)=>r.key===Y?t.jsx(te,{placeholder:"请输入备注",defaultValue:e,onPressEnter:a=>{r.name=a.target.value,k([...u]),localStorage.setItem("linea_addresses",JSON.stringify(u)),E(null)}}):t.jsxs(t.Fragment,{children:[t.jsx(oe,{color:"blue",onClick:()=>E(r.key),children:e}),!e&&t.jsx(K,{shape:"circle",icon:t.jsx(le,{}),size:"small",onClick:()=>E(r.key)})]}),width:70},{title:t.jsxs("span",{children:["钱包地址",t.jsx("span",{onClick:Z,style:{marginLeft:8,cursor:"pointer"},children:q()})]}),dataIndex:"address",key:"address",align:"center",render:e=>C?"***":e,width:200},{title:"最后交易",dataIndex:"linea_last_tx",key:"linea_last_tx",align:"center",render:(e,r)=>{let s="inherit";return e===null?t.jsx(h,{}):(e!=null&&e.includes("天")&&parseInt(e)>7?s="red":s="#1677ff",t.jsx("a",{href:"https://lineascan.build/address/"+r.address,target:"_blank",style:{color:s},children:e}))},width:65},{title:t.jsxs("a",{href:"https://defillama.com/chain/zkSync Era",style:{color:"white"},target:"_blank",rel:"noopener noreferrer",children:["zkSyncEra Task List  [参考defillama TVL数据] ",t.jsx("br",{}),"🔴请注意，通过点击任务列表的超链接，您将离开本网页。我们建议您在访问这些外部链接之前，仔细阅读其网站的隐私政策和使用条款。我们不能控制这些网站的内容和安全性，并且不对其造成的任何损失或损害负责。 在访问外部链接时，您需要自行评估潜在的风险。这些链接不构成对所链接网站内容的认可或支持。我们不对这些外部链接的准确性、内容、服务质量或安全性做任何承诺。 我们建议您保持您的计算机和设备的安全性，使用防病毒软件和防火墙，并时刻注意潜在的网络钓鱼或恶意软件攻击。 通过继续使用本网页并访问其中的超链接，您同意承担访问外部链接可能带来的一切风险。我们不对由此导致的任何损失或损害负责！"]}),key:"zks_era_group",className:"zks_era",children:[{title:t.jsx("a",{href:"https://app.horizondex.io/swap",target:"_blank",rel:"noopener noreferrer",children:"horizondex"}),dataIndex:"horizon",key:"horizon",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.horizon===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://lineabank.finance/bank",target:"_blank",rel:"noopener noreferrer",children:"LineaBank"}),dataIndex:"bank",key:"bank",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.bank===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://syncswap.xyz/",target:"_blank",rel:"noopener noreferrer",children:"syncSwap"}),dataIndex:"sync",key:"sync",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.sync===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://izumi.finance/trade/swap",target:"_blank",rel:"noopener noreferrer",children:"iZiSwap"}),dataIndex:"izi",key:"izi",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.izi===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://www.echodex.io/swap",target:"_blank",rel:"noopener noreferrer",children:"EchoDEX"}),dataIndex:"echo",key:"echo",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.echo===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://linea.leetswap.finance/#/swap",target:"_blank",rel:"noopener noreferrer",children:"leetSwap"}),dataIndex:"leet",key:"leet",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.leet===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:t.jsx("a",{href:"https://www.swirllend.com/",target:"_blank",rel:"noopener noreferrer",children:"SwirlLend"}),dataIndex:"swirl",key:"swirl",align:"center",filters:[{text:"未完成",value:0}],onFilter:(e,r)=>r.swirl===e,render:(e,r)=>t.jsx("span",{style:{color:e===0?"red":"inherit"},children:e===null?t.jsx(h,{}):e}),width:65},{title:"进度",dataIndex:"progress",key:"progress",align:"center",sorter:(e,r)=>e.progress-r.progress,render:(e,r)=>{const s=["horizon","bank","sync","izi","echo","leet","swirl"],n=s.reduce((g,d)=>r[d]>0?g+1:g,0)/s.length*100;r.progress=n;const m=`rgba(240, 121, 78, ${n/100})`;return{children:t.jsx("span",{children:e===null?t.jsx(h,{}):`${n.toFixed(2)}%`}),props:{style:{background:m}}}},width:65}]}];return t.jsx("div",{children:t.jsx(ue,{children:t.jsx(h,{spinning:S,children:t.jsx(ae,{rowSelection:W,dataSource:M,pagination:!1,bordered:!0,style:{marginBottom:"0px",zIndex:2},size:"small",columns:ee,scroll:{y:R},footer:()=>t.jsx(ie,{children:t.jsx("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",gap:"10px"},children:t.jsx(K,{type:"primary",onClick:U,loading:c,size:"large",style:{width:"20%"},icon:t.jsx(de,{}),children:c?"正在刷新":"刷新选中地址"})})})})})})})}export{_e as default};
