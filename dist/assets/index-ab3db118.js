import{r as D,j as r}from"./index-b2ef79c2.js";import{U as Ft,D as Nt,e as Dt}from"./save_excel-c19756b0.js";import{a as N}from"./axios-4a70c6fc.js";import{F as K}from"./index-172dc63e.js";import{M as yt,P as pt,D as kt}from"./DeleteOutlined-d98d3dbe.js";import{I as ct,S as T,E as At,a as Ot}from"./index-fa1a6c2a.js";import{T as H,a as Ut}from"./index-7b773b73.js";import{C as Gt}from"./index-08b925e2.js";import{B as q,E as Jt}from"./EditOutlined-8b010ab0.js";import{L as $t}from"./index-5e132e59.js";import{n as R}from"./FileSaver.min-7cd7f937.js";import{S as Pt}from"./index-d41603e6.js";import{S as wt}from"./SyncOutlined-620b68af.js";import{P as Bt}from"./PlusOutlined-23b712b3.js";import"./useFlexGapSupport-2bb9cee6.js";import"./Sider-05241123.js";import"./row-431da211.js";import"./index-5a7f0b26.js";async function X(f){try{let h=0,y,x;const _="https://starkscan.stellate.sh/",l={authority:"starkscan.stellate.sh",accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json"},i={query:`query TransactionsTableQuery(
              $first: Int!,
              $after: String,
              $input: TransactionsInput!
            ) {
              ...TransactionsTablePaginationFragment_transactions_2DAjA4
            }
            
            fragment TransactionsTableExpandedItemFragment_transaction on Transaction {
              entry_point_selector_name
              calldata_decoded
              entry_point_selector
              calldata
              initiator_address
              initiator_identifier
              main_calls {
                selector
                selector_name
                calldata_decoded
                selector_identifier
                calldata
                contract_address
                contract_identifier
                id
              }
            }
            
            fragment TransactionsTablePaginationFragment_transactions_2DAjA4 on Query {
              transactions(
                first: $first,
                after: $after,
                input: $input
              ) {
                edges {
                  node {
                    id
                    ...TransactionsTableRowFragment_transaction
                    __typename
                  }
                  cursor
                }
                pageInfo {
                  endCursor
                  hasNextPage
                }
              }
            }
            
            fragment TransactionsTableRowFragment_transaction on Transaction {
              id
              transaction_hash
              block_number
              transaction_status
              transaction_type
              timestamp
              initiator_address
              initiator_identifier
              initiator {
                is_social_verified
                id
              }
              main_calls {
                selector_identifier
                id
              }
              ...TransactionsTableExpandedItemFragment_transaction
            }`,variables:{first:30,after:null,input:{initiator_address:f,sort_by:"timestamp",order_by:"desc",min_block_number:null,max_block_number:null,min_timestamp:null,max_timestamp:null}}},u=await N.post(_,i,{headers:l});for(let F=0;F<u.data.data.transactions.edges.length;F++)u.data.data.transactions.edges[F].node.transaction_type==="INVOKE_FUNCTION"&&(h+=1);y=u.data.data.transactions.pageInfo.hasNextPage;const E=u.data.data.transactions.edges[0].node.timestamp,p=u.data.data.transactions.edges.map(F=>F.node.timestamp*1e3),g=new Date(E*1e3);let b=g.getFullYear(),w=g.getMonth()+1,C=g.getDate();w<10&&(w="0"+w),C<10&&(C="0"+C);let Y=`${b}/${w}/${C}`;if(y===!0)for(x=u.data.data.transactions.pageInfo.endCursor;y;){i.variables.after=x;const F=await N.post(_,i,{headers:l});y=F.data.data.transactions.pageInfo.hasNextPage,x=F.data.data.transactions.pageInfo.endCursor;for(let tt=0;tt<F.data.data.transactions.edges.length;tt++)F.data.data.transactions.edges[tt].node.transaction_type==="INVOKE_FUNCTION"&&(h+=1)}const dt=new Date(E*1e3),V=8,_t=new Date(dt.getTime()+V*3600*1e3),lt=new Date,mt=new Date(lt.getTime()+V*3600*1e3)-_t,Z=Math.floor(mt/(1e3*60*60)),it=Math.floor(Z/24);let W="";return it>0?W=`${it} 天前`:Z>0?W=`${Z} 小时前`:W="刚刚",console.log(h,Y,W),{tx:h,stark_latest_tx:Y,stark_latest_tx_time:W,stark_timestamps:p}}catch(h){return console.error(h),{tx:"Error",stark_latest_tx:"Error"}}}async function xt(f,h,y,x){for(let _=0;_<x.length;_++){const l=x[_].node;l.transaction_hash;const i=l.transfer_amount_display,u=l.transfer_from_address,E=l.transfer_to_address;l.timestamp,l.transfer_to_identifier;const p=l.main_call?l.main_call.selector_identifier:null,g=l.from_erc20_identifier;if(u==="0x0000000000000000000000000000000000000000000000000000000000000000"&&p==="handle_deposit"){const b=l.from_erc20_identifier;if(b in h){const w=h[b].amount+=parseFloat(i),C=h[b].count+=1;h[b]={amount:w,count:C}}else h[b]={amount:parseFloat(i),count:1}}else if(E==="0x0000000000000000000000000000000000000000000000000000000000000000"&&g==="StarkGate: ETH"){const b=l.from_erc20_identifier;if(b in y){const w=y[b].amount+=parseFloat(i),C=y[b].count+=1;y[b]={amount:w,count:C}}else y[b]={amount:parseFloat(i),count:1}}}return[h,y]}async function nt(f){try{const h="https://starkscan.stellate.sh/",y={authority:"starkscan.stellate.sh",accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json"},x={query:`query ERC20TransferEventsTableQuery(
  $first: Int!
  $after: String
  $input: ERC20TransferEventsInput!
) {
  ...ERC20TransferEventsTablePaginationFragment_erc20TransferEvents_2DAjA4
}

fragment ERC20TransferEventsTablePaginationFragment_erc20TransferEvents_2DAjA4 on Query {
  erc20TransferEvents(first: $first, after: $after, input: $input) {
    edges {
      node {
        id
        ...ERC20TransferEventsTableRowFragment_erc20TransferEvent
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment ERC20TransferEventsTableRowFragment_erc20TransferEvent on ERC20TransferEvent {
  id
  transaction_hash
  from_address
  from_erc20_identifier
  from_contract {
    is_social_verified
    id
  }
  transfer_from_address
  transfer_from_identifier
  transfer_from_contract {
    is_social_verified
    id
  }
  transfer_to_address
  transfer_to_identifier
  transfer_to_contract {
    is_social_verified
    id
  }
  transfer_amount
  transfer_amount_display
  timestamp
  main_call {
    selector_identifier
    id
  }
}
`,variables:{first:30,after:null,input:{transfer_from_or_to_address:f,call_invocation_type:"FUNCTION",sort_by:"timestamp",order_by:"desc"}}};let _=await N.post(h,x,{headers:y}),l=_.data.data.erc20TransferEvents.edges,i={},u={},E=_.data.data.erc20TransferEvents.pageInfo.hasNextPage,p;for([i,u]=await xt(f,i,u,l),E&&(p=_.data.data.erc20TransferEvents.pageInfo.endCursor);E===!0;){x.variables.after=p;let w=await N.post(h,x,{headers:y});E=w.data.data.erc20TransferEvents.pageInfo.hasNextPage,E===!1?p=null:p=w.data.data.erc20TransferEvents.pageInfo.endCursor,[i,u]=await xt(f,i,u,w.data.data.erc20TransferEvents.edges)}let g=0,b=0;for(let w in i)g+=i[w].count;for(let w in u)b+=u[w].count;return console.log(i),console.log(u),{d_eth_amount:i["StarkGate: ETH"]?parseFloat(i["StarkGate: ETH"].amount).toFixed(3):0,d_eth_count:i["StarkGate: ETH"]?i["StarkGate: ETH"].count:0,d_usdc_amount:i["StarkGate: USDC"]?parseFloat(i["StarkGate: USDC"].amount).toFixed(3):0,d_usdc_count:i["StarkGate: USDC"]?i["StarkGate: USDC"].count:0,d_usdt_amount:i["StarkGate: USDT"]?parseFloat(i["StarkGate: USDT"].amount).toFixed(3):0,d_usdt_count:i["StarkGate: USDT"]?i["StarkGate: USDT"].count:0,d_dai_amount:i["StarkGate: DAI"]?parseFloat(i["StarkGate: DAI"].amount).toFixed(3):0,d_dai_count:i["StarkGate: DAI"]?i["StarkGate: DAI"].count:0,d_wbtc_amount:i["StarkGate: WBTC"]?parseFloat(i["StarkGate: WBTC"].amount).toFixed(6):0,d_wbtc_count:i["StarkGate: WBTC"]?i["StarkGate: WBTC"].count:0,w_eth_amount:u["StarkGate: ETH"]?parseFloat(u["StarkGate: ETH"].amount).toFixed(3):0,w_eth_count:u["StarkGate: ETH"]?u["StarkGate: ETH"].count:0,w_usdc_amount:u["StarkGate: USDC"]?parseFloat(u["StarkGate: USDC"].amount).toFixed(3):0,w_usdc_count:u["StarkGate: USDC"]?u["StarkGate: USDC"].count:0,w_usdt_amount:u["StarkGate: USDT"]?parseFloat(u["StarkGate: USDT"].amount).toFixed(3):0,w_usdt_count:u["StarkGate: USDT"]?u["StarkGate: USDT"].count:0,w_dai_amount:u["StarkGate: DAI"]?parseFloat(u["StarkGate: DAI"].amount).toFixed(3):0,w_dai_count:u["StarkGate: DAI"]?u["StarkGate: DAI"].count:0,w_wbtc_amount:u["StarkGate: WBTC"]?parseFloat(u["StarkGate: WBTC"].amount).toFixed(6):0,w_wbtc_count:u["StarkGate: WBTC"]?u["StarkGate: WBTC"].count:0,total_deposit_count:g,total_widthdraw_count:b}}catch(h){return console.log(h),{d_eth_amount:"Error",d_eth_count:"Error",d_usdc_amount:"Error",d_usdc_count:"Error",d_usdt_amount:"Error",d_usdt_count:"Error",d_dai_amount:"Error",d_dai_count:"Error",d_wbtc_amount:"Error",d_wbtc_count:"Error",w_eth_amount:"Error",w_eth_count:"Error",w_usdc_amount:"Error",w_usdc_count:"Error",w_usdt_amount:"Error",w_usdt_count:"Error",w_dai_amount:"Error",w_dai_count:"Error",w_wbtc_amount:"Error",w_wbtc_count:"Error",total_deposit_count:"Error",total_widthdraw_count:"Error"}}}async function st(f){var h;try{let y=`https://voyager.online/api/contract/${f}`;const x=await N.get(y),_=x.data.creationTimestamp,l=(h=x.data)==null?void 0:h.classAlias;let i=x.data.contractAlias;return i===null&&(i="/"),{wallet_type:l,deployed_at_timestamp:_,stark_id:i}}catch(y){return console.error(y),{wallet_type:"Error",deployed_at_timestamp:"Error",stark_id:"Error"}}}async function ft(f){try{const h="https://starkscan.stellate.sh/",x={method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify({query:`query ERC20BalancesByOwnerAddressTableQuery($input: ERC20BalancesByOwnerAddressInput!) {
  erc20BalancesByOwnerAddress(input: $input) {
    id
    contract_address
    balance_display
  }
}`,variables:{input:{owner_address:f}}})},i=(await N.post(h,x.data,x)).data.data.erc20BalancesByOwnerAddress;let u=0,E=0,p=0,g=0;for(let b=0;b<i.length;b++){const w=i[b];w.contract_address==="0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7"&&(u=parseFloat(w.balance_display)),w.contract_address==="0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8"&&(E=parseFloat(w.balance_display)),w.contract_address==="0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8"&&(p=parseFloat(w.balance_display)),w.contract_address==="0x00da114221cb83fa859dbdb4c44beeaa0bb37c7537ad5ae66fe5e0efd20e6eb3"&&(g=parseFloat(w.balance_display))}return{eth_balance:u.toFixed(4),usdc_balance:E.toFixed(2),usdt_balance:p.toFixed(2),dai_balance:g.toFixed(2)}}catch(h){return console.error("Error fetching USDC balance:",h),{eth_balance:"Error",usdc_balance:"Error",usdt_balance:"Error",dai_balance:"Error"}}}function zt(f){return`${f.getUTCFullYear()}-${f.getUTCMonth()+1}-${f.getUTCDate()}`}function Lt(f){f=new Date(Date.UTC(f.getFullYear(),f.getMonth(),f.getDate())),f.setUTCDate(f.getUTCDate()+4-(f.getUTCDay()||7));let h=new Date(Date.UTC(f.getUTCFullYear(),0,1)),y=Math.ceil(((f-h)/864e5+1)/7);return f.getUTCFullYear()+"W"+y}function Mt(f){return f.getUTCFullYear()+"-"+(f.getUTCMonth()+1)}async function rt(f){try{let h,y,x,_=new Set,l=new Set,i=new Set,u=`https://voyager.online/api/txns?to=${f}&ps=50&p=1&type=null`;const E=await N.get(u);let p=E.data.items.map(g=>new Date(g.timestamp*1e3));for(let g=2;g<=E.data.lastPage;g++){const b=`https://voyager.online/api/txns?to=${f}=50&p=${g}&type=null`,C=(await N.get(b)).data.items.map(Y=>Y.timestamp);p.concat(C)}return p.forEach(g=>{_.add(zt(g)),l.add(Lt(g)),i.add(Mt(g))}),h=_.size,y=l.size,x=i.size,{dayActivity:h,weekActivity:y,monthActivity:x}}catch(h){return console.error(h),{dayActivity:"Error",weekActivity:"Error",monthActivity:"Error"}}}const Rt=async()=>{try{return(await N.post("https://mainnet.era.zksync.io/",{id:42,jsonrpc:"2.0",method:"zks_getTokenPrice",params:["0x0000000000000000000000000000000000000000"]})).data.result}catch(f){return console.log(f),1900}};async function ot(f){try{const h=await Rt();let y=`https://voyager.online/api/contract/${f}/transfers?ps=50&p=1`;const _=(await N.get(y)).data.lastPage;let l=0;for(let i=1;i<=_;i++){const u=`https://voyager.online/api/contract/${f}/transfers?ps=50&p=${i}`,p=(await N.get(u)).data.items;for(let g=0;g<p.length;g++)if(p[g].transfer_from.toLowerCase()===f.toLowerCase()&&p[g].transfer_to.toLowerCase()!=="0x01176a1bd84444c89232ec27754698e5d2e7e1a7f1539f12027f28b23ec9f3d8"){const b=p[g].token_symbol;b==="ETH"?l+=parseFloat(p[g].transfer_value)*parseFloat(h):b==="USDC"&&(l+=parseFloat(p[g].transfer_value))}}return{stark_exchange_amount:l.toFixed(2)}}catch(h){return console.error(h),{stark_exchange_amount:"Error"}}}async function gt(f){try{let h=`https://voyager.online/api/contract/${f}/balances`;const y=await N.get(h),x=parseFloat(y.data.ethereum.amount).toFixed(4),_=parseFloat(y.data["usd-coin"].amount).toFixed(2),l=parseFloat(y.data.tether.amount).toFixed(2),i=parseFloat(y.data.dai.amount).toFixed(2);return{eth_balance:x,usdc_balance:_,usdt_balance:l,dai_balance:i}}catch(h){return console.error(h),{eth_balance:"Error",usdc_balance:"Error",usdt_balance:"Error",dai_balance:"Error"}}}const{TextArea:Ht}=ct,{Content:qt}=$t,_e=()=>{const[f,h]=D.useState(!1),[y,x]=D.useState(!1),[_,l]=D.useState([]),[i]=K.useForm(),[u,E]=D.useState(!1),[p,g]=D.useState([]),[b,w]=D.useState(!1),[C]=K.useForm(),[Y,dt]=D.useState(0),[V,_t]=D.useState(!1),lt=()=>{_t(!V)},ut=()=>V?r.jsx(At,{}):r.jsx(Ot,{});D.useEffect(()=>{const t=()=>{dt(window.innerHeight-260)};return window.addEventListener("resize",t),t(),()=>{window.removeEventListener("resize",t)}},[]),D.useEffect(()=>{w(!0);const t=localStorage.getItem("stark_addresses");setTimeout(()=>{w(!1)},500),t&&l(JSON.parse(t))},[]);const mt=t=>{l(_.filter(o=>o.key!==t)),localStorage.setItem("stark_addresses",JSON.stringify(_.filter(o=>o.key!==t)))},Z=async()=>{try{const t=await C.validateFields();if(t.address.length!==66&&t.address.length!==64){R.error({message:"错误",description:"请输入正确的stark地址(64位)"},2);return}t.address.startsWith("0x")||(t.address="0x"+t.address),h(!1);const o=_.findIndex(a=>a.address===t.address);if(o!==-1){l(_.map((s,c)=>c===o?{...s,name:t.name}:s));const a=[..._];st(t.address).then(({wallet_type:s,deployed_at_timestamp:c,stark_id:n})=>{a[o]={...a[o],wallet_type:s,create_time:c,stark_id:n},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))}),gt(t.address).then(({eth_balance:s,usdc_balance:c,usdt_balance:n,dai_balance:d})=>{a[o]={...a[o],stark_eth_balance:s,stark_usdc_balance:c,stark_usdt_balance:n,stark_dai_balance:d},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))}),rt(t.address).then(({dayActivity:s,weekActivity:c,monthActivity:n})=>{a[o]={...a[o],dayActivity:s,weekActivity:c,monthActivity:n},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))}),ot(t.address).then(({stark_exchange_amount:s})=>{a[o]={...a[o],stark_exchange_amount:s},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))}),nt(t.address).then(({d_eth_amount:s,d_eth_count:c,d_usdc_amount:n,d_usdc_count:d,d_usdt_amount:m,d_usdt_count:k,d_dai_amount:e,d_dai_count:S,d_wbtc_amount:I,d_wbtc_count:v,w_eth_amount:j,w_eth_count:A,w_usdc_amount:O,w_usdc_count:U,w_usdt_amount:G,w_usdt_count:J,w_dai_amount:$,w_dai_count:P,w_wbtc_amount:B,w_wbtc_count:z,total_deposit_count:L,total_widthdraw_count:M})=>{a[o]={...a[o],d_eth_amount:s,d_eth_count:c,d_usdc_amount:n,d_usdc_count:d,d_usdt_amount:m,d_usdt_count:k,d_dai_amount:e,d_dai_count:S,d_wbtc_amount:I,d_wbtc_count:v,w_eth_amount:j,w_eth_count:A,w_usdc_amount:O,w_usdc_count:U,w_usdt_amount:G,w_usdt_count:J,w_dai_amount:$,w_dai_count:P,w_wbtc_amount:B,w_wbtc_count:z,total_deposit_count:L,total_widthdraw_count:M},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))}),X(t.address).then(({tx:s,stark_latest_tx_time:c})=>{a[o]={...a[o],stark_tx_amount:s,stark_latest_tx_time:c},l(a),localStorage.setItem("stark_addresses",JSON.stringify(_))})}else{const a={key:_.length.toString(),name:t.name,address:t.address,stark_eth_balance:null,stark_usdc_balance:null,stark_usdt_balance:null,stark_dai_balance:null,dayActivity:null,weekActivity:null,monthActivity:null,stark_exchange_amount:null,stark_id:null,create_time:null,d_eth_amount:null,d_eth_count:null,d_usdc_amount:null,d_usdc_count:null,d_usdt_amount:null,d_usdt_count:null,d_dai_amount:null,d_dai_count:null,d_wbtc_amount:null,d_wbtc_count:null,w_eth_amount:null,w_eth_count:null,w_usdc_amount:null,w_usdc_count:null,w_usdt_amount:null,w_usdt_count:null,w_dai_amount:null,w_dai_count:null,w_wbtc_amount:null,w_wbtc_count:null,stark_tx_amount:null,stark_latest_tx:null,stark_latest_tx_time:null,total_deposit_count:null,total_widthdraw_count:null},s=[..._,a];l(s),X(t.address).then(({tx:c,stark_latest_tx_time:n})=>{a.stark_tx_amount=c,a.stark_latest_tx_time=n,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),st(t.address).then(({wallet_type:c,deployed_at_timestamp:n,stark_id:d})=>{a.wallet_type=c,a.create_time=n,a.stark_id=d,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),gt(t.address).then(({eth_balance:c,usdc_balance:n,usdt_balance:d,dai_balance:m})=>{a.stark_eth_balance=c,a.stark_usdc_balance=n,a.stark_usdt_balance=d,a.stark_dai_balance=m,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),rt(t.address).then(({dayActivity:c,weekActivity:n,monthActivity:d})=>{a.dayActivity=c,a.weekActivity=n,a.monthActivity=d,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),ot(t.address).then(({stark_exchange_amount:c})=>{a.stark_exchange_amount=c,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),nt(t.address).then(({d_eth_amount:c,d_eth_count:n,d_usdc_amount:d,d_usdc_count:m,d_usdt_amount:k,d_usdt_count:e,d_dai_amount:S,d_dai_count:I,d_wbtc_amount:v,d_wbtc_count:j,w_eth_amount:A,w_eth_count:O,w_usdc_amount:U,w_usdc_count:G,w_usdt_amount:J,w_usdt_count:$,w_dai_amount:P,w_dai_count:B,w_wbtc_amount:z,w_wbtc_count:L,total_widthdraw_count:M,total_deposit_count:Q})=>{a.d_eth_amount=c,a.d_eth_count=n,a.d_usdc_amount=d,a.d_usdc_count=m,a.d_usdt_amount=k,a.d_usdt_count=e,a.d_dai_amount=S,a.d_dai_count=I,a.d_wbtc_amount=v,a.d_wbtc_count=j,a.w_eth_amount=A,a.w_eth_count=O,a.w_usdc_amount=U,a.w_usdc_count=G,a.w_usdt_amount=J,a.w_usdt_count=$,a.w_dai_amount=P,a.w_dai_count=B,a.w_wbtc_amount=z,a.w_wbtc_count=L,a.total_deposit_count=Q,a.total_widthdraw_count=M,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))})}}catch(t){R.error({message:"错误",description:t.message},2)}finally{C.resetFields()}},it=async()=>{try{const o=(await i.validateFields()).addresses.split(`
`),a=[..._];for(let s of o){if(s=s.trim(),s.length!==66&&s.length!==64){R.error({message:"错误",description:"请输入正确的stark地址(64位)"});continue}s.startsWith("0x")||(s="0x"+s);const c=a.findIndex(n=>n.address===s);if(c!==-1){const n=[...a];X(s).then(({tx:d,stark_latest_tx_time:m})=>{n[c]={...n[c],stark_tx_amount:d,stark_latest_tx_time:m},l(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),st(s).then(({wallet_type:d,deployed_at_timestamp:m,stark_id:k})=>{n[c]={...n[c],wallet_type:d,create_time:m,stark_id:k},l(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),ft(s).then(({eth_balance:d,usdc_balance:m,usdt_balance:k,dai_balance:e})=>{n[c]={...n[c],stark_eth_balance:d,stark_usdc_balance:m,stark_usdt_balance:k,stark_dai_balance:e},l(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),rt(s).then(({dayActivity:d,weekActivity:m,monthActivity:k})=>{n[c]={...n[c],dayActivity:d,weekActivity:m,monthActivity:k},l(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),ot(s).then(({stark_exchange_amount:d})=>{n[c]={...n[c],stark_exchange_amount:d},l(n),localStorage.setItem("stark_addresses",JSON.stringify(n))}),nt(s).then(({d_eth_amount:d,d_eth_count:m,d_usdc_amount:k,d_usdc_count:e,d_usdt_amount:S,d_usdt_count:I,d_dai_amount:v,d_dai_count:j,d_wbtc_amount:A,d_wbtc_count:O,w_eth_amount:U,w_eth_count:G,w_usdc_amount:J,w_usdc_count:$,w_usdt_amount:P,w_usdt_count:B,w_dai_amount:z,w_dai_count:L,w_wbtc_amount:M,w_wbtc_count:Q,total_widthdraw_count:et,total_deposit_count:at})=>{n[c]={...n[c],d_eth_amount:d,d_eth_count:m,d_usdc_amount:k,d_usdc_count:e,d_usdt_amount:S,d_usdt_count:I,d_dai_amount:v,d_dai_count:j,d_wbtc_amount:A,d_wbtc_count:O,w_eth_amount:U,w_eth_count:G,w_usdc_amount:J,w_usdc_count:$,w_usdt_amount:P,w_usdt_count:B,w_dai_amount:z,w_dai_count:L,w_wbtc_amount:M,w_wbtc_count:Q,total_widthdraw_count:et,total_deposit_count:at}}),await new Promise(d=>setTimeout(d,2e3))}else{const n={key:a.length.toString(),address:s,stark_eth_balance:null,stark_usdc_balance:null,stark_usdt_balance:null,stark_dai_balance:null,dayActivity:null,weekActivity:null,monthActivity:null,stark_exchange_amount:null,stark_id:null,create_time:null,d_eth_amount:null,d_eth_count:null,d_usdc_amount:null,d_usdc_count:null,d_usdt_amount:null,d_usdt_count:null,d_dai_amount:null,d_dai_count:null,d_wbtc_amount:null,d_wbtc_count:null,w_eth_amount:null,w_eth_count:null,w_usdc_amount:null,w_usdc_count:null,w_usdt_amount:null,w_usdt_count:null,w_dai_amount:null,w_dai_count:null,w_wbtc_amount:null,w_wbtc_count:null,stark_tx_amount:null,stark_latest_tx:null,stark_latest_tx_time:null,total_deposit_count:null,total_widthdraw_count:null};a.push(n),l(a),X(s).then(({tx:d,stark_latest_tx_time:m})=>{n.stark_tx_amount=d,n.stark_latest_tx_time=m,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),st(s).then(({wallet_type:d,deployed_at_timestamp:m,stark_id:k})=>{n.wallet_type=d,n.create_time=m,n.stark_id=k,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),gt(s).then(({eth_balance:d,usdc_balance:m,usdt_balance:k,dai_balance:e})=>{n.stark_eth_balance=d,n.stark_usdc_balance=m,n.stark_usdt_balance=k,n.stark_dai_balance=e,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),rt(s).then(({dayActivity:d,weekActivity:m,monthActivity:k})=>{n.dayActivity=d,n.weekActivity=m,n.monthActivity=k,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),ot(s).then(({stark_exchange_amount:d})=>{n.stark_exchange_amount=d,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),nt(s).then(({d_eth_amount:d,d_eth_count:m,d_usdc_amount:k,d_usdc_count:e,d_usdt_amount:S,d_usdt_count:I,d_dai_amount:v,d_dai_count:j,d_wbtc_amount:A,d_wbtc_count:O,w_eth_amount:U,w_eth_count:G,w_usdc_amount:J,w_usdc_count:$,w_usdt_amount:P,w_usdt_count:B,w_dai_amount:z,w_dai_count:L,w_wbtc_amount:M,w_wbtc_count:Q,total_widthdraw_count:et,total_deposit_count:at})=>{n.d_eth_amount=d,n.d_eth_count=m,n.d_usdc_amount=k,n.d_usdc_count=e,n.d_usdt_amount=S,n.d_usdt_count=I,n.d_dai_amount=v,n.d_dai_count=j,n.d_wbtc_amount=A,n.d_wbtc_count=O,n.w_eth_amount=U,n.w_eth_count=G,n.w_usdc_amount=J,n.w_usdc_count=$,n.w_usdt_amount=P,n.w_usdt_count=B,n.w_dai_amount=z,n.w_dai_count=L,n.w_wbtc_amount=M,n.w_wbtc_count=Q,n.total_widthdraw_count=et,n.total_deposit_count=at,l([...a]),localStorage.setItem("stark_addresses",JSON.stringify(a))}),await new Promise(d=>setTimeout(d,2e3))}}x(!1)}catch(t){R.error({message:"错误",description:t.message})}finally{i.resetFields(),g([])}},W=async()=>{if(!p.length){R.error({message:"错误",description:"请先选择要刷新的地址"},2);return}E(!0);try{let o=0,a=[];const s=[..._];let c=[];const n=()=>{for(;o<20&&a.length>0;){const m=a.shift();o+=1,m().finally(()=>{o-=1,n()})}};for(let m of p){const k=s.findIndex(e=>e.key===m);if(k!==-1){const e=s[k];e.stark_tx_amount=null,e.stark_latest_tx=null,e.stark_latest_tx_time=null,e.stark_eth_balance=null,e.stark_usdc_balance=null,e.stark_usdt_balance=null,e.stark_dai_balance=null,e.d_eth_amount=null,e.d_eth_count=null,e.d_usdc_amount=null,e.d_usdc_count=null,e.d_usdt_amount=null,e.d_usdt_count=null,e.d_dai_amount=null,e.d_dai_count=null,e.d_wbtc_amount=null,e.d_wbtc_count=null,e.w_eth_amount=null,e.w_eth_count=null,e.w_usdc_amount=null,e.w_usdc_count=null,e.w_usdt_amount=null,e.w_usdt_count=null,e.w_dai_amount=null,e.w_dai_count=null,e.w_wbtc_amount=null,e.w_wbtc_count=null,e.total_widthdraw_count=null,e.total_deposit_count=null,l([...s]),a.push(()=>X(e.address).then(({tx:S,stark_latest_tx_time:I,stark_timestamps:v})=>{e.stark_tx_amount=S,e.stark_latest_tx_time=I,c.push(v),l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(_))})),a.push(()=>ft(e.address).then(({eth_balance:S,usdc_balance:I,usdt_balance:v,dai_balance:j})=>{e.stark_eth_balance=S,e.stark_usdc_balance=I,e.stark_usdt_balance=v,e.stark_dai_balance=j,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(_))})),a.push(()=>nt(e.address).then(({d_eth_amount:S,d_eth_count:I,d_usdc_amount:v,d_usdc_count:j,d_usdt_amount:A,d_usdt_count:O,d_dai_amount:U,d_dai_count:G,d_wbtc_amount:J,d_wbtc_count:$,w_eth_amount:P,w_eth_count:B,w_usdc_amount:z,w_usdc_count:L,w_usdt_amount:M,w_usdt_count:Q,w_dai_amount:et,w_dai_count:at,w_wbtc_amount:It,w_wbtc_count:vt,total_widthdraw_count:Ct,total_deposit_count:jt})=>{e.d_eth_amount=S,e.d_eth_count=I,e.d_usdc_amount=v,e.d_usdc_count=j,e.d_usdt_amount=A,e.d_usdt_count=O,e.d_dai_amount=U,e.d_dai_count=G,e.d_wbtc_amount=J,e.d_wbtc_count=$,e.w_eth_amount=P,e.w_eth_count=B,e.w_usdc_amount=z,e.w_usdc_count=L,e.w_usdt_amount=M,e.w_usdt_count=Q,e.w_dai_amount=et,e.w_dai_count=at,e.w_wbtc_amount=It,e.w_wbtc_count=vt,e.total_widthdraw_count=Ct,e.total_deposit_count=jt,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(_))}))}n()}for(;o>0||a.length>0;)await new Promise(m=>setTimeout(m,2e3));const d=c.flat();localStorage.setItem("stark_timestamps",JSON.stringify(d));for(let m of p){const k=s.findIndex(e=>e.key===m);if(k!==-1){const e=s[k];e.dayActivity=null,e.weekActivity=null,e.monthActivity=null,e.stark_exchange_amount=null,(e.wallet_type==="Error"||e.wallet_type===void 0)&&st(e.address).then(({wallet_type:S,deployed_at_timestamp:I,stark_id:v})=>{e.wallet_type=S,e.create_time=I,e.stark_id=v,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),rt(e.address).then(({dayActivity:S,weekActivity:I,monthActivity:v})=>{e.dayActivity=S,e.weekActivity=I,e.monthActivity=v,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),ot(e.address).then(({stark_exchange_amount:S})=>{e.stark_exchange_amount=S,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(s))}),await new Promise(S=>setTimeout(S,5e3))}}}catch(t){R.error({message:"错误",description:t.message},2)}finally{E(!1),g([])}},F=async()=>{if(!p.length){R.error({message:"错误",description:"请先选择要刷新的地址"},2);return}E(!0);try{let o=0,a=[];const s=[..._];let c=[];const n=()=>{for(;o<20&&a.length>0;){const m=a.shift();o+=1,m().finally(()=>{o-=1,n()})}};for(let m of p){const k=s.findIndex(e=>e.key===m);if(k!==-1){const e=s[k];e.stark_tx_amount=null,e.stark_latest_tx_time=null,e.stark_eth_balance=null,e.stark_usdc_balance=null,e.stark_usdt_balance=null,e.stark_dai_balance=null,l([...s]),a.push(()=>X(e.address).then(({tx:S,stark_latest_tx_time:I,stark_timestamps:v})=>{e.stark_tx_amount=S,e.stark_latest_tx_time=I,c.push(v),l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(_))})),a.push(()=>ft(e.address).then(({eth_balance:S,usdc_balance:I,usdt_balance:v,dai_balance:j})=>{e.stark_eth_balance=S,e.stark_usdc_balance=I,e.stark_usdt_balance=v,e.stark_dai_balance=j,l([...s]),localStorage.setItem("stark_addresses",JSON.stringify(_))}))}n()}for(;o>0||a.length>0;)await new Promise(m=>setTimeout(m,2e3));const d=c.flat();localStorage.setItem("stark_timestamps",JSON.stringify(d))}catch(t){R.error({message:"错误",description:t.message},2)}finally{E(!1),g([])}},tt=()=>{if(!p.length){R.error({message:"错误",description:"请先选择要删除的地址"},2);return}l(_.filter(t=>!p.includes(t.key))),localStorage.setItem("stark_addresses",JSON.stringify(_.filter(t=>!p.includes(t.key)))),g([])},bt=()=>{Dt(_,"starkInfo")},[St,ht]=D.useState(null),Tt=[{title:"#",key:"index",align:"center",render:(t,o,a)=>a+1,width:60},{title:"备注",dataIndex:"name",key:"name",align:"center",className:"name",render:(t,o)=>o.key===St?r.jsx(ct,{placeholder:"请输入备注",defaultValue:t,onPressEnter:s=>{o.name=s.target.value,l([..._]),localStorage.setItem("stark_addresses",JSON.stringify(_)),ht(null)}}):r.jsxs(r.Fragment,{children:[r.jsx(Ut,{color:"blue",onClick:()=>ht(o.key),children:t}),!t&&r.jsx(q,{shape:"circle",icon:r.jsx(Jt,{}),size:"small",onClick:()=>ht(o.key)})]}),width:100},{title:r.jsxs("span",{children:["钱包地址",r.jsx("span",{onClick:lt,style:{marginLeft:8,cursor:"pointer"},children:ut()})]}),dataIndex:"address",key:"address",align:"center",className:"address",render:(t,o)=>V?"***":t===null?r.jsx(T,{}):t.slice(0,6)+"..."+t.slice(-6),width:140},{title:r.jsxs("span",{children:["starkId",r.jsx("span",{onClick:lt,style:{marginLeft:8,cursor:"pointer"},children:ut()})]}),dataIndex:"stark_id",key:"stark_id",align:"center",className:"stark_id",render:(t,o)=>V?"***":t===null?r.jsx(T,{}):t,width:100},{title:"创建时间",dataIndex:"create_time",key:"create_time",align:"center",className:"create_time",render:(t,o)=>{if(t===null)return r.jsx(T,{});{let a=new Date(t*1e3),s=a.getFullYear(),c=(a.getMonth()+1).toString().padStart(2,"0"),n=a.getDate().toString().padStart(2,"0");return`${s}/${c}/${n}`}},width:100},{title:"钱包类型",dataIndex:"wallet_type",key:"wallet_type",align:"center",className:"wallet_type",render:(t,o)=>t===null?r.jsx(T,{}):t===void 0||t==="Error"?"/":t==null?void 0:t.slice(0,-5),width:80},{title:"StarkNet   🔴建议减少刷新次数",className:"starkNet",children:[{title:"ETH",dataIndex:"stark_eth_balance",key:"stark_eth_balance",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:70},{title:"USDC",dataIndex:"stark_usdc_balance",key:"stark_usdc_balance",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:70},{title:"USDT",dataIndex:"stark_usdt_balance",key:"stark_usdt_balance",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:70},{title:"DAI",dataIndex:"stark_dai_balance",key:"stark_dai_balance",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:70},{title:"Tx",dataIndex:"stark_tx_amount",key:"stark_tx_amount",align:"center",sorter:(t,o)=>t.stark_tx_amount-o.stark_tx_amount,render:(t,o)=>{if(t===null)return r.jsx(T,{});const a=Math.log(t),s=Math.log(1),c=Math.log(100),n=(a-s)/(c-s),d=.1,e=`rgba(173, 216, 230, ${n*(1-d)+d})`;return{children:t,props:{style:{background:e}}}},width:70},{title:"最后交易",dataIndex:"stark_latest_tx_time",key:"stark_latest_tx_time",align:"center",render:(t,o)=>{let a="inherit";return t===null?r.jsx(T,{}):(t!=null&&t.includes("天")&&parseInt(t)>7?a="red":a="#1677ff",r.jsx("a",{href:"https://starkscan.co/contract/"+o.address,target:"_blank",style:{color:a},children:t}))},width:70},{title:"活跃统计",key:"activity_stats_group",children:[{title:"日",dataIndex:"dayActivity",key:"dayActivity",align:"center",sorter:(t,o)=>t.dayActivity-o.dayActivity,render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"周",dataIndex:"weekActivity",key:"weekActivity",align:"center",sorter:(t,o)=>t.weekActivity-o.weekActivity,render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"月",dataIndex:"monthActivity",key:"monthActivity",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"交易金额",dataIndex:"stark_exchange_amount",key:"stark_exchange_amount",align:"center",sorter:(t,o)=>t.stark_exchange_amount-o.stark_exchange_amount,render:(t,o)=>{if(t===null)return r.jsx(T,{});const a=Math.log(t),s=Math.log(1),c=Math.log(100),n=(a-s)/(c-s),d=.1,e=`rgba(211, 211, 211, ${n*(1-d)+d})`;return{children:t,props:{style:{background:e}}}},width:100}]},{title:"官方桥Tx数量",className:"stark_cross_tx",children:[{title:"L1->L2",dataIndex:"total_deposit_count",key:"12cross_total_tx",align:"center",render:(t,o)=>r.jsx("span",{style:{color:t===0?"red":"inherit"},children:t===null?r.jsx(T,{}):t}),width:60},{title:"L2->L1",dataIndex:"total_widthdraw_count",key:"21cross_total_tx",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60}]},{title:"官方桥跨链额",className:"stark_cross_amount",children:[{title:"L1->L2",children:[{title:"ETH",dataIndex:"d_eth_amount",key:"12cross_eth_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"USDT",dataIndex:"d_usdt_amount",key:"12cross_usdt_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"USDC",dataIndex:"d_usdc_amount",key:"12cross_usdc_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60}]},{title:"L2->L1",className:"cross21",children:[{title:"ETH",dataIndex:"w_eth_amount",key:"21cross_eth_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"USDT",dataIndex:"w_usdt_amount",key:"21cross_usdt_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60},{title:"USDC",dataIndex:"w_usdc_amount",key:"21cross_usdc_amount",align:"center",render:(t,o)=>t===null?r.jsx(T,{}):t,width:60}]}]},{title:"操作",key:"action",align:"center",render:(t,o)=>r.jsx(Pt,{size:"small",children:r.jsx(pt,{title:"确认删除？",onConfirm:()=>mt(o.key),children:r.jsx(q,{icon:r.jsx(kt,{})})})}),width:60}]}],Et={selectedRowKeys:p,onChange:t=>{g(t)}};return r.jsx("div",{children:r.jsxs(qt,{children:[r.jsx(yt,{title:"批量添加地址",open:y,onOk:it,onCancel:()=>{x(!1),i.resetFields()},okText:"添加地址",cancelText:"取消",children:r.jsx(K,{form:i,layout:"vertical",children:r.jsx(K.Item,{label:"地址",name:"addresses",rules:[{required:!0}],children:r.jsx(Ht,{placeholder:"请输入地址，每行一个",style:{width:"500px",height:"200px"}})})})}),r.jsx(yt,{title:"添加地址",open:f,onOk:Z,onCancel:()=>h(!1),okText:"添加地址",cancelText:"取消",children:r.jsxs(K,{form:C,layout:"vertical",children:[r.jsx(K.Item,{label:"地址",name:"address",rules:[{required:!0}],children:r.jsx(ct,{placeholder:"请输入地址"})}),r.jsx(K.Item,{label:"备注",name:"name",children:r.jsx(ct,{placeholder:"请输入备注"})})]})}),r.jsx(T,{spinning:b,children:r.jsx(H,{rowSelection:Et,dataSource:_,pagination:!1,bordered:!0,style:{marginBottom:"0px"},size:"small",columns:Tt,scroll:{y:Y},summary:t=>{let o=0,a=0,s=0,c=0;t.forEach(({stark_eth_balance:d,stark_usdc_balance:m,stark_usdt_balance:k,stark_dai_balance:e})=>{o+=Number(d),a+=Number(m),s+=Number(k),c+=Number(e)});const n=Array(15).fill().map((d,m)=>r.jsx(H.Summary.Cell,{index:m+10},m));return r.jsx(r.Fragment,{children:r.jsxs(H.Summary.Row,{children:[r.jsx(H.Summary.Cell,{index:0,colSpan:7,children:"总计"}),r.jsx(H.Summary.Cell,{index:6,children:o.toFixed(4)}),r.jsx(H.Summary.Cell,{index:7,children:a.toFixed(2)}),r.jsx(H.Summary.Cell,{index:8,children:s.toFixed(2)}),r.jsx(H.Summary.Cell,{index:9,children:c.toFixed(2)}),n]})})},footer:()=>r.jsx(Gt,{children:r.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between"},children:[r.jsx(q,{type:"primary",onClick:F,loading:u,size:"large",style:{width:"16%"},icon:r.jsx(wt,{}),children:"快速刷新选中地址"}),r.jsx(q,{type:"primary",onClick:W,loading:u,size:"large",style:{width:"16%"},icon:r.jsx(wt,{}),children:"刷新选中地址（慢）"}),r.jsx(q,{type:"primary",onClick:()=>{h(!0)},size:"large",style:{width:"16%"},icon:r.jsx(Bt,{}),children:"添加地址"}),r.jsx(q,{type:"primary",onClick:()=>{x(!0)},size:"large",style:{width:"16%"},icon:r.jsx(Ft,{}),children:"批量添加地址"}),r.jsx(pt,{title:"确认删除"+p.length+"个地址？",onConfirm:tt,children:r.jsx(q,{type:"primary",danger:!0,size:"large",style:{width:"16%"},icon:r.jsx(kt,{}),children:"删除选中地址"})}),r.jsx(q,{type:"primary",icon:r.jsx(Nt,{}),size:"large",style:{width:"8%"},onClick:bt})]})})})})]})})};export{_e as default};
